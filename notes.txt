public static <T> void validateHeaders(String[] FIELD_MAPPING, int sheetIndex, int startIndex, MultipartFile file) throws Exception {
    try (Workbook workbook = new XSSFWorkbook(file.getInputStream())) {
        // Validate workbook and sheet
        if (workbook == null) {
            throw new InvalidRequest("Workbook is null");
        }
        Sheet sheet = workbook.getSheetAt(sheetIndex);
        if (sheet == null) {
            throw new InvalidRequest("Sheet at index " + sheetIndex + " not found");
        }

        Row row = sheet.getRow(startIndex);
        if (row == null) {
            throw new InvalidRequest("Row at index " + startIndex + " not found");
        }

        List<String> headingList = new ArrayList<>();
        DataFormatter dataFormatter = new DataFormatter();

        // Collect headers
        for (int i = 0; i < FIELD_MAPPING.length; i++) {
            Cell cell = row.getCell(i);
            String cellValue = (cell != null) ? dataFormatter.formatCellValue(cell).trim() : "";
            headingList.add(cellValue);
        }

        // Validate headers using Stream
        for (int i = 0; i < headingList.size(); i++) {
            String expected = FIELD_MAPPING[i];
            String actual = headingList.get(i);
            if (!actual.equals(expected)) {
                throw new InvalidTemplateException("The input excel template being used is " +
                    "not correct. Please re-download the latest one from SSP Portal. " +
                    "Expected column with name '" + expected + "' at index " + i);
            }
        }
    } catch (InvalidTemplateException e) {
        log.info(e.getMessage());
        throw e;
    } catch (Exception e) {
        log.info(e.getMessage());
        throw new InvalidRequest("Exception occurred while reading column headers.", e);
    }
}
